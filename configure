#!/bin/bash

INCLUDES=($(grep -E '^-include .*\s$' Makefile | awk 'BEGIN {FS = " "}; {print $2}'))

for I in "${INCLUDES[@]}"; do
    FILE=$(echo $I|tr -d '\r\n')
    if [ -f "$FILE" ]; then
        echo "$FILE already exists"
    else
        mkdir -p $(dirname $FILE)
        NAME=$(basename $FILE)
        URL=$(echo "https://raw.githubusercontent.com/jamesbrond/jamesbrond/main/Makefile/$NAME")

        echo "get $URL"
        curl -H 'Cache-Control: no-cache, no-store' ${URL} -o $FILE
    fi
done